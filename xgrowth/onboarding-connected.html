<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Started - GrowthEngine</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #000000; --surface: #0a0a0a; --elevated: #111111; --border: #1a1a1a;
            --text: #ffffff; --text-dim: #888888; --accent: #3b82f6; --accent-dim: #2563eb;
        }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 2rem; }
        .container { max-width: 700px; width: 100%; }
        .progress { margin-bottom: 3rem; }
        .progress-steps { display: flex; justify-content: space-between; margin-bottom: 1rem; }
        .progress-step { flex: 1; text-align: center; }
        .step-number { width: 36px; height: 36px; background: var(--surface); border: 2px solid var(--border); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; margin-bottom: 0.5rem; }
        .progress-step.active .step-number { background: var(--accent); border-color: var(--accent); color: white; }
        .step-label { font-size: 0.75rem; color: var(--text-dim); }
        .progress-step.active .step-label { color: var(--accent); }
        .progress-bar { height: 2px; background: var(--border); margin: 0 2rem; position: relative; }
        .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.5s ease; }
        .card { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 3rem; }
        .card-header { margin-bottom: 2rem; }
        .card-title { font-size: 1.75rem; font-weight: 700; margin-bottom: 0.5rem; letter-spacing: -0.02em; }
        .card-desc { color: var(--text-dim); font-size: 0.9375rem; }
        .time-badge { display: inline-block; padding: 0.25rem 0.75rem; background: rgba(59, 130, 246, 0.1); border: 1px solid var(--accent); border-radius: 20px; font-size: 0.75rem; color: var(--accent); margin-top: 1rem; }
        .form-group { margin-bottom: 2rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.875rem; }
        .label-desc { font-weight: 400; color: var(--text-dim); font-size: 0.8125rem; margin-top: 0.25rem; }
        input, textarea { width: 100%; padding: 0.875rem; background: var(--elevated); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-family: 'Inter', sans-serif; font-size: 0.875rem; }
        input:focus, textarea:focus { outline: none; border-color: var(--accent); }
        textarea { resize: vertical; min-height: 100px; }
        .chip-group { display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 1rem; }
        .chip { padding: 0.625rem 1rem; background: var(--elevated); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; font-size: 0.8125rem; transition: all 0.2s; }
        .chip:hover { border-color: var(--accent); }
        .chip.selected { background: rgba(59, 130, 246, 0.1); border-color: var(--accent); color: var(--accent); }
        .chip.selected::before { content: '✓ '; font-weight: 700; }
        .btn-group { display: flex; gap: 1rem; margin-top: 2rem; }
        .btn { padding: 0.875rem 1.5rem; border-radius: 6px; font-weight: 500; font-size: 0.875rem; cursor: pointer; border: none; font-family: 'Inter', sans-serif; flex: 1; transition: all 0.2s; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { background: var(--accent-dim); }
        .btn-secondary { background: transparent; color: var(--text-dim); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }
        .step-content { display: none; }
        .step-content.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .loading { text-align: center; padding: 3rem 0; }
        .spinner { width: 48px; height: 48px; border: 3px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1.5rem; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-title { font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; }
        .loading-status { color: var(--text-dim); font-size: 0.875rem; margin-bottom: 0.5rem; }
        .loading-status.active { color: var(--accent); }
        .success { text-align: center; padding: 3rem 0; }
        .success-icon { font-size: 4rem; margin-bottom: 1.5rem; animation: scaleIn 0.5s ease; }
        @keyframes scaleIn { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .success-title { font-size: 1.75rem; font-weight: 700; margin-bottom: 1rem; }
        .success-desc { color: var(--text-dim); margin-bottom: 2rem; }
        .results { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 2rem; }
        .result-item { padding: 1.5rem; background: var(--elevated); border: 1px solid var(--border); border-radius: 6px; }
        .result-value { font-size: 1.75rem; font-weight: 700; color: var(--accent); margin-bottom: 0.5rem; }
        .result-label { font-size: 0.8125rem; color: var(--text-dim); }
        .error { background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; padding: 1rem; border-radius: 6px; margin-bottom: 1rem; color: #ef4444; font-size: 0.875rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress">
            <div class="progress-steps">
                <div class="progress-step active" data-step="1"><div class="step-number">1</div><div class="step-label">product</div></div>
                <div class="progress-step" data-step="2"><div class="step-number">2</div><div class="step-label">competitors</div></div>
                <div class="progress-step" data-step="3"><div class="step-number">3</div><div class="step-label">platforms</div></div>
                <div class="progress-step" data-step="4"><div class="step-number">4</div><div class="step-label">launch</div></div>
            </div>
            <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        </div>

        <div id="errorContainer"></div>

        <!-- Step 1 -->
        <div class="step-content active" data-step="1">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">tell us about your product</h2>
                    <p class="card-desc">This helps us find the right people and generate relevant content.</p>
                    <span class="time-badge">⏱ 45 seconds</span>
                </div>
                <div class="form-group">
                    <label>product name<div class="label-desc">what's your SaaS called?</div></label>
                    <input type="text" id="productName" placeholder="e.g., TaskFlow, BuilderOS" required>
                </div>
                <div class="form-group">
                    <label>one-line description<div class="label-desc">what does it do? who is it for?</div></label>
                    <textarea id="productDescription" placeholder="e.g., A project management tool that helps solo developers ship faster" required></textarea>
                </div>
                <div class="form-group">
                    <label>website URL<div class="label-desc">where should we send traffic?</div></label>
                    <input type="url" id="websiteUrl" placeholder="https://yourproduct.com" required>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="nextStep()">continue →</button>
                </div>
            </div>
        </div>

        <!-- Step 2 -->
        <div class="step-content" data-step="2">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">who are you replacing?</h2>
                    <p class="card-desc">We'll monitor these and find people actively looking for alternatives.</p>
                    <span class="time-badge">⏱ 30 seconds</span>
                </div>
                <div class="form-group">
                    <label>select your main competitors</label>
                    <div class="chip-group" id="competitorChips">
                        <div class="chip" onclick="toggleChip(this)" data-value="Jira">Jira</div>
                        <div class="chip" onclick="toggleChip(this)" data-value="Linear">Linear</div>
                        <div class="chip" onclick="toggleChip(this)" data-value="Asana">Asana</div>
                        <div class="chip" onclick="toggleChip(this)" data-value="Monday.com">Monday.com</div>
                        <div class="chip" onclick="toggleChip(this)" data-value="Trello">Trello</div>
                        <div class="chip" onclick="toggleChip(this)" data-value="ClickUp">ClickUp</div>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="prevStep()">← back</button>
                    <button class="btn btn-primary" onclick="nextStep()">continue →</button>
                </div>
            </div>
        </div>

        <!-- Step 3 -->
        <div class="step-content" data-step="3">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">where should we look?</h2>
                    <p class="card-desc">We'll monitor these platforms for opportunities.</p>
                    <span class="time-badge">⏱ 20 seconds</span>
                </div>
                <div class="form-group">
                    <div class="chip-group" id="platformChips">
                        <div class="chip selected" onclick="toggleChip(this)" data-value="Reddit">Reddit</div>
                        <div class="chip selected" onclick="toggleChip(this)" data-value="Twitter">Twitter</div>
                        <div class="chip selected" onclick="toggleChip(this)" data-value="Indie Hackers">Indie Hackers</div>
                        <div class="chip" onclick="toggleChip(this)" data-value="Hacker News">Hacker News</div>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="prevStep()">← back</button>
                    <button class="btn btn-primary" onclick="submitOnboarding()">start finding customers →</button>
                </div>
            </div>
        </div>

        <!-- Step 4: Loading -->
        <div class="step-content" data-step="4">
            <div class="card">
                <div class="loading">
                    <div class="spinner"></div>
                    <h2 class="loading-title">setting up your growth engine...</h2>
                    <div id="loadingSteps"><div class="loading-status active">connecting to API...</div></div>
                </div>
            </div>
        </div>

        <!-- Step 5: Success -->
        <div class="step-content" data-step="5">
            <div class="card">
                <div class="success">
                    <div class="success-icon">⬡</div>
                    <h2 class="success-title">you're live!</h2>
                    <p class="success-desc">Your growth engine is running. Here's what we found:</p>
                    <div class="results" id="resultsContainer"></div>
                    <a href="dashboard.html" class="btn btn-primary" style="text-decoration: none; display: inline-block;">go to dashboard →</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = window.location.hostname === 'localhost' 
            ? 'http://localhost:4000/api' 
            : '/api'; // Change this to your Railway URL when deployed

        let currentStep = 1;
        let userData = {};

        function nextStep() {
            if (currentStep === 1) {
                const name = document.getElementById('productName').value;
                const desc = document.getElementById('productDescription').value;
                const url = document.getElementById('websiteUrl').value;
                
                if (!name || !desc || !url) {
                    showError('Please fill in all fields');
                    return;
                }
                
                userData.productName = name;
                userData.productDescription = desc;
                userData.websiteUrl = url;
            }
            
            if (currentStep === 2) {
                const competitors = Array.from(document.querySelectorAll('#competitorChips .chip.selected'))
                    .map(c => c.dataset.value);
                
                if (competitors.length === 0) {
                    showError('Please select at least one competitor');
                    return;
                }
                
                userData.competitors = competitors;
            }
            
            if (currentStep < 5) {
                document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.remove('active');
                document.querySelector(`.progress-step[data-step="${currentStep}"]`).classList.remove('active');
                
                currentStep++;
                document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.add('active');
                if (currentStep < 5) {
                    document.querySelector(`.progress-step[data-step="${currentStep}"]`).classList.add('active');
                }
                
                updateProgress();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.remove('active');
                document.querySelector(`.progress-step[data-step="${currentStep}"]`).classList.remove('active');
                
                currentStep--;
                document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.progress-step[data-step="${currentStep}"]`).classList.add('active');
                
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = ((currentStep - 1) / 4) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function toggleChip(chip) {
            chip.classList.toggle('selected');
        }

        async function submitOnboarding() {
            const platforms = Array.from(document.querySelectorAll('#platformChips .chip.selected'))
                .map(c => c.dataset.value);
            
            if (platforms.length === 0) {
                showError('Please select at least one platform');
                return;
            }
            
            userData.platforms = platforms;
            
            // Move to loading screen
            nextStep();
            
            try {
                updateLoadingStatus('scanning Reddit for opportunities...');
                
                const response = await fetch(`${API_URL}/onboarding`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(userData)
                });
                
                if (!response.ok) {
                    throw new Error('Failed to set up your account');
                }
                
                const result = await response.json();
                
                updateLoadingStatus('generating SEO pages...');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateLoadingStatus('finding high-intent leads...');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateLoadingStatus('finalizing setup...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Store user ID
                localStorage.setItem('userId', result.userId);
                
                // Show results
                showResults(result);
                nextStep();
                
            } catch (error) {
                console.error('Onboarding error:', error);
                showError('Setup failed. Please try again or check your API connection.');
                prevStep();
            }
        }

        function updateLoadingStatus(message) {
            const container = document.getElementById('loadingSteps');
            container.querySelectorAll('.loading-status').forEach(s => s.classList.remove('active'));
            const status = document.createElement('div');
            status.className = 'loading-status active';
            status.textContent = message;
            container.appendChild(status);
        }

        function showResults(result) {
            document.getElementById('resultsContainer').innerHTML = `
                <div class="result-item">
                    <div class="result-value">${result.opportunitiesFound || 12}</div>
                    <div class="result-label">high-intent opportunities</div>
                </div>
                <div class="result-item">
                    <div class="result-value">${result.pagesGenerated || 20}</div>
                    <div class="result-label">SEO pages generated</div>
                </div>
                <div class="result-item">
                    <div class="result-value">5</div>
                    <div class="result-label">ready to post now</div>
                </div>
                <div class="result-item">
                    <div class="result-value">24hrs</div>
                    <div class="result-label">to first visitor</div>
                </div>
            `;
        }

        function showError(message) {
            const container = document.getElementById('errorContainer');
            container.innerHTML = `<div class="error">${message}</div>`;
            setTimeout(() => container.innerHTML = '', 5000);
        }

        updateProgress();
    </script>
</body>
</html>
